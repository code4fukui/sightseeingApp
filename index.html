<h1>福井県観光アンケートコメントマップ</h1>
<div id="divmap"></div>
<script type="module">
import { LeafletGSI } from "https://js.sabae.cc/LeafletGSI.js";
import { CSV } from "https://js.sabae.cc/CSV.js";
const map = await LeafletGSI.initMap("divmap");
map.setView([35.943, 136.19], 15);
const url = "https://code4fukui.github.io/fukui-kanko-survey/area.csv"
const area = CSV.toJSON(await CSV.fetch(url));
console.log(area);
const urldata = "https://coffeepot74.github.io/sightseeingApp/data.csv"
const data = CSV.toJSON(await CSV.fetch(urldata));
console.log(data);
for(const d of data){
    const a = area.find(a => d.回答エリア == a.エリア名);
    console.log(a);
    const r = 0.01;
    const marker = L.marker([parseFloat(a.緯度) + Math.random()*r*2-r, parseFloat(a.経度) + Math.random()*r*2-r], 
        { icon: L.spriteIcon(d.color)});
    marker.bindPopup(`エリア: ${d.回答エリア} <br><br> 旅行者情報: ${d.会員市町村}, ${d.年代} <br><br> 満足・不満足: ${d.満足度の理由} <br><br> 不便さ: ${d.不便さの内容} <br><br> 交通手段について: ${d.福井県内での交通手段の満足度の理由}
        <br><br> 施設へのコメント: ${d.施設に求めるもの} <br><br> 福井へのコメント: ${d.福井県に求めるもの}`)
    marker.addTo(map);
}



</script>
<style>
    #divmap {
        height: 90vh;
        width: 100%;
    }
</style>